<!DOCTYPE html>
<html>
  <head>
    <title>Magma Bird</title>
    <script src="https://aframe.io/releases/0.3.2/aframe.min.js"></script>
  </head>
  <body>

    <audio autoplay loop>
      <source src="music.mp3" type="audio/mpeg" />
    </audio>

      <a-scene fog="type: linear; far: 31; near: 0">
      <a-entity id="camera" position="20 5 -4" rotation="0 90 0"><a-camera look-controls="false" wasd-controls-enabled="true"></a-camera></a-entity>
      <a-sky color="#CCFFFF"></a-sky>
      <a-entity ground position="-14 0 0"></a-entity>

<!-- bottom ones -->
      <a-cylinder position="10 0 -4" radius="0.6" height="8" color="#660000"></a-cylinder>
      <a-cylinder position="6 0 -4" radius="0.6" height="9" color="#660000"></a-cylinder>
      <a-cylinder position="2 0 -4" radius="0.6" height="11" color="#660000"></a-cylinder>
      <a-cylinder position="-2 0 -4" radius="0.6" height="7" color="#660000"></a-cylinder>
      <a-cylinder position="-6 0 -4" radius="0.6" height="13" color="#660000"></a-cylinder>
      <a-cylinder position="-10 0 -4" radius="0.6" height="11" color="#660000"></a-cylinder>
      <a-cylinder position="-14 0 -4" radius="0.6" height="10" color="#660000"></a-cylinder>
      <a-cylinder position="-18 0 -4" radius="0.6" height="14" color="#660000"></a-cylinder>
      <a-cylinder position="-22 0 -4" radius="0.6" height="12" color="#660000"></a-cylinder>
      <a-cylinder position="-26 0 -4" radius="0.6" height="8" color="#660000"></a-cylinder>

      <a-cylinder position="10 13 -4" radius="0.6" height="9" color="#660000"></a-cylinder>
        <a-cylinder position="6 13 -4" radius="0.6" height="8" color="#660000"></a-cylinder>
        <a-cylinder position="2 13 -4" radius="0.6" height="6" color="#660000"></a-cylinder>
        <a-cylinder position="-2 13 -4" radius="0.6" height="10" color="#660000"></a-cylinder>
        <a-cylinder position="-6 13 -4" radius="0.6" height="4" color="#660000"></a-cylinder>
        <a-cylinder position="-10 13 -4" radius="0.6" height="6" color="#660000"></a-cylinder>
        <a-cylinder position="-14 13 -4" radius="0.6" height="7" color="#660000"></a-cylinder>
        <a-cylinder position="-18 13 -4" radius="0.6" height="3" color="#660000"></a-cylinder>
        <a-cylinder position="-22 13 -4" radius="0.6" height="7" color="#660000"></a-cylinder>
        <a-cylinder position="-26 13 -4" radius="0.6" height="9" color="#660000"></a-cylinder>
    </a-scene>
  </body>

<script>

var camera = document.getElementById("camera");
var cameraX = 20;
var cameraY = 5;
var falling = 0;

document.addEventListener('keydown', function() {
  falling = -0.04;
});

function loop() {
  camera.setAttribute('position', cameraX + ' ' + (cameraY - 1.5) + ' -4');
  cameraX = cameraX - 0.035;
  cameraY = cameraY - falling;
  falling = falling + 0.0008;

  if (cameraX<-27) {
    location.reload();
    clearInterval(loopId);
  }

  if (cameraY<0) {
    alert("You hit the Ground");
    clearInterval(loopId);
  }

  if ((cameraX<10.6 && cameraX>9.4) && (cameraY < 4 || cameraY > 8.5)) {
    clearInterval(loopId);
    location.reload();
  }
  if ((cameraX<6.6 && cameraX>5.4) && (cameraY < 4.5 || cameraY > 9)) {
    clearInterval(loopId);
    location.reload();
  }
  if ((cameraX<2.6 && cameraX>1.4) && (cameraY < 5.5 || cameraY > 10)) {
    clearInterval(loopId);
    location.reload();
  }
  if ((cameraX<-1.4 && cameraX>-2.6) && (cameraY < 3.5 || cameraY > 8)) {
    clearInterval(loopId);
    location.reload();
  }
  if ((cameraX<-5.4 && cameraX>-6.6) && (cameraY <6.5 || cameraY > 11)) {
    clearInterval(loopId);
    location.reload();
  }
  if ((cameraX<-9.4 && cameraX>-10.6) && (cameraY <5.5 || cameraY > 10)) {
    clearInterval(loopId);
    location.reload();
  }
  if ((cameraX<-13.4 && cameraX>-14.6) && (cameraY <5 || cameraY >9.5 )) {
    clearInterval(loopId);
    location.reload();
  }
  if ((cameraX<-17.4 && cameraX>-18.6) && (cameraY <7 || cameraY >11.5 )) {
    clearInterval(loopId);
    location.reload();
  }
  if ((cameraX<-21.4 && cameraX>-22.6) && (cameraY <6 || cameraY >9.5 )) {
    clearInterval(loopId);
    location.reload();
  }
  if ((cameraX<-25.4 && cameraX>-26.6) && (cameraY <4 || cameraY >8.5 )) {
    clearInterval(loopId);
    location.reload();
  }
}

loopId = setInterval(loop, 10);

AFRAME.registerComponent('ground', {
  init: function () {
    var objectLoader;
    var object3D = this.el.object3D;
    var MODEL_URL = 'https://cdn.aframe.io/link-traversal/models/ground.json';
    if (this.objectLoader) { return; }
    objectLoader = this.objectLoader = new THREE.ObjectLoader();
    objectLoader.crossOrigin = '';
    objectLoader.load(MODEL_URL, function (obj) {
      object3D.add(obj);
    });
  }
});

</script>

</html>
